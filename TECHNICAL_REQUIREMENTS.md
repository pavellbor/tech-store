# Техническое задание TechStore

## О проекте

TechStore — интернет-магазин электроники. Пользователи могут просматривать каталог товаров, добавлять их в корзину, управлять корзиной и оформлять заказы. Система поддерживает авторизацию пользователей, фильтрацию товаров и сохранение состояния корзины.

## 1. Описание функциональности

### 1.1. Страницы приложения

Приложение состоит из страниц: Main (/), Catalog (/catalog), Product (/product/:id), Cart (/cart), Login (/login).

Если пользователь авторизован, то при переходе на страницу Login выполняется перенаправление на главную страницу.

В шапке каждой страницы отображается ссылка на страницу Login (если пользователь не авторизован) или имя пользователя и кнопка "Выйти" (если пользователь авторизован).

Клик по кнопке "Выйти" приводит к завершению сеанса работы.

В шапке отображается счетчик товаров в корзине. Добавление или удаление товаров приводит к немедленному пересчету количества.

Обращение к несуществующей странице корректно обрабатывается маршрутизацией. Пользователь перенаправляется на страницу 404.

### 1.1.1. Главная страница

На главной странице отображается:
- Блок категорий товаров: Телефоны, Ноутбуки, Аксессуары
- Список популярных товаров

Клик по категории выполняет переход на страницу каталога с примененным фильтром по категории.

Клик по товару выполняет переход на страницу товара.

Кнопка "Добавить в корзину" добавляет товар в корзину с количеством 1.

### 1.1.2. Страница каталога

На странице каталога отображается:
- Боковая панель с фильтрами
- Список товаров
- Элементы управления сортировкой
- Пагинация

#### 1.1.2.1. Фильтрация

Доступные фильтры:
- По категории: Все товары, Телефоны, Ноутбуки, Аксессуары
- По цене: диапазон от минимальной до максимальной цены

Применение фильтров обновляет список товаров и URL страницы.

#### 1.1.2.2. Сортировка

Варианты сортировки:
- По популярности (по умолчанию)
- Цена: по возрастанию
- Цена: по убыванию
- Новинки

При смене варианта сортировки список товаров перерисовывается.

#### 1.1.2.3. Список товаров

Каждая карточка товара содержит:
- Изображение товара
- Название товара
- Цену (текущую и старую, если есть скидка)
- Кнопку "Добавить в корзину"

Клик по названию товара выполняет переход на страницу товара.

Если товары отсутствуют, отображается сообщение "Товары не найдены".

#### 1.1.2.4. Пагинация

Отображается при количестве товаров больше установленного лимита на страницу.

Переход между страницами обновляет URL и список товаров.

### 1.1.3. Страница товара

На странице товара отображается:
- Галерея изображений товара
- Название товара
- Цена (текущая и старая, если есть скидка)
- Описание товара
- Элемент управления количеством
- Кнопка "Добавить в корзину"
- Блок "Похожие товары"

#### 1.1.3.1. Галерея изображений

Отображается основное изображение и миниатюры дополнительных изображений.

Клик по миниатюре меняет основное изображение.

#### 1.1.3.2. Управление количеством

Пользователь может выбрать количество товара для добавления в корзину.

Минимальное количество: 1.

#### 1.1.3.3. Похожие товары

Отображается список товаров той же категории.

Каждый товар содержит ту же информацию, что и в каталоге.

### 1.1.4. Страница корзины

На странице корзины отображается:
- Список товаров в корзине
- Итоговая информация
- Кнопка "Оформить заказ"

#### 1.1.4.1. Список товаров

Каждый товар в корзине содержит:
- Изображение товара
- Название товара
- Цену за единицу
- Элемент управления количеством
- Кнопку удаления товара

Изменение количества пересчитывает стоимость товара и общую сумму.

Удаление товара убирает его из корзины и пересчитывает общую сумму.

#### 1.1.4.2. Итоговая информация

Отображается:
- Количество товаров
- Общая стоимость товаров
- Стоимость доставки
- Итоговая сумма к оплате

#### 1.1.4.3. Управление корзиной

Кнопка "Очистить корзину" удаляет все товары из корзины.

Если корзина пуста, отображается сообщение "Корзина пуста" и кнопка перехода к покупкам.

### 1.1.5. Страница авторизации

Страница содержит две формы: вход и регистрация.

Переключение между формами осуществляется табами.

#### 1.1.5.1. Форма входа

Поля:
- Email (обязательное, валидация email)
- Пароль (обязательное, минимум 8 символов)
- Чекбокс "Запомнить меня"

#### 1.1.5.2. Форма регистрации

Поля:
- Имя и фамилия (обязательное, минимум 2 символа)
- Email (обязательное, валидация email)
- Телефон (необязательное)
- Пароль (обязательное, минимум 8 символов)
- Подтверждение пароля (должно совпадать с паролем)
- Чекбокс согласия с условиями (обязательное)

Валидация полей происходит в реальном времени.

Кнопка отправки активна только при корректном заполнении всех обязательных полей.

## 2. Сущности данных

### 2.1. Product (Товар)

```typescript
interface Product {
  id: string
  name: string
  description: string
  price: number
  oldPrice?: number
  images: string[]
  category: string
  inStock: boolean
  stockQuantity: number
  createdAt: string
}
```

### 2.2. Category (Категория)

```typescript
interface Category {
  id: string
  name: string
  slug: string
}
```

### 2.3. CartItem (Товар в корзине)

```typescript
interface CartItem {
  id: string
  product: Product
  quantity: number
  subtotal: number
}
```

### 2.4. User (Пользователь)

```typescript
interface User {
  id: string
  name: string
  email: string
  phone?: string
}
```

### 2.5. AuthCredentials (Данные авторизации)

```typescript
interface LoginCredentials {
  email: string
  password: string
  rememberMe: boolean
}

interface RegisterData {
  name: string
  email: string
  phone?: string
  password: string
  passwordConfirm: string
  agreeToTerms: boolean
}
```

## 3. Состояние приложения

### 3.1. Структура состояния

```typescript
interface AppState {
  products: ProductsState
  cart: CartState
  auth: AuthState
  ui: UIState
}

interface ProductsState {
  items: Product[]
  categories: Category[]
  currentProduct: Product | null
  relatedProducts: Product[]
  filters: {
    category: string[]
    priceRange: [number, number]
    sortBy: string
  }
  pagination: {
    currentPage: number
    totalPages: number
    itemsPerPage: number
  }
  loading: boolean
  error: string | null
}

interface CartState {
  items: CartItem[]
  total: number
  itemsCount: number
}

interface AuthState {
  user: User | null
  isAuthenticated: boolean
  loading: boolean
  error: string | null
}

interface UIState {
  searchQuery: string
  notifications: Notification[]
}
```

### 3.2. Действия (Actions)

#### 3.2.1. Товары

- `loadProducts()` - загрузка списка товаров
- `loadProductById(id: string)` - загрузка товара по ID
- `searchProducts(query: string)` - поиск товаров
- `setFilters(filters: Filters)` - установка фильтров
- `setSorting(sortBy: string)` - установка сортировки
- `setPage(page: number)` - установка текущей страницы

#### 3.2.2. Корзина

- `addToCart(productId: string, quantity: number)` - добавление товара в корзину
- `updateCartItem(itemId: string, quantity: number)` - изменение количества товара
- `removeFromCart(itemId: string)` - удаление товара из корзины
- `clearCart()` - очистка корзины
- `loadCart()` - загрузка корзины из localStorage
- `saveCart()` - сохранение корзины в localStorage

#### 3.2.3. Авторизация

- `login(credentials: LoginCredentials)` - вход пользователя
- `register(userData: RegisterData)` - регистрация пользователя
- `logout()` - выход пользователя
- `checkAuth()` - проверка авторизации при загрузке приложения

#### 3.2.4. UI

- `setSearchQuery(query: string)` - установка поискового запроса
- `showNotification(message: string, type: string)` - показ уведомления
- `hideNotification(id: string)` - скрытие уведомления

## 4. Маршрутизация

### 4.1. Структура маршрутов

```typescript
const routes = [
  { path: '/', component: HomePage },
  { path: '/catalog', component: CatalogPage },
  { path: '/product/:id', component: ProductPage },
  { path: '/cart', component: CartPage },
  { path: '/login', component: LoginPage },
  { path: '/404', component: NotFoundPage },
  { path: '/:pathMatch(.*)*', redirect: '/404' }
]
```

### 4.2. Параметры маршрутов

- `/catalog` поддерживает query параметры для фильтров: `?category=phones&priceFrom=1000&priceTo=50000&sortBy=price-asc&page=2`
- `/product/:id` принимает ID товара как параметр маршрута

### 4.3. Навигационные guards

- Проверка авторизации для защищенных маршрутов
- Редирект авторизованных пользователей с страницы Login
- Обработка несуществующих товаров

## 5. Управление данными

### 5.1. Источники данных

- Статические JSON файлы с товарами и категориями
- localStorage для корзины и настроек пользователя
- sessionStorage для временных данных сессии

### 5.2. Валидация данных

#### 5.2.1. Валидация форм

```typescript
const validationRules = {
  email: {
    required: true,
    pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/
  },
  password: {
    required: true,
    minLength: 8
  },
  name: {
    required: true,
    minLength: 2
  },
  quantity: {
    required: true,
    min: 1,
    max: 99
  }
}
```

#### 5.2.2. Валидация корзины

- Проверка наличия товара на складе при добавлении
- Проверка максимального количества товара
- Валидация целостности данных корзины при загрузке

## 6. Бизнес-логика

### 6.1. Расчет стоимости

- Стоимость товара = цена × количество
- Общая стоимость корзины = сумма стоимостей всех товаров
- Доставка бесплатная при сумме заказа от 5000 рублей

### 6.2. Управление количеством товаров

- Минимальное количество в корзине: 1
- Максимальное количество ограничено остатком на складе
- При превышении лимита показывается предупреждение

### 6.3. Фильтрация и поиск

- Поиск выполняется по названию товара
- Фильтрация по категории: точное совпадение
- Фильтрация по цене: товары в указанном диапазоне
- Сортировка применяется после фильтрации

### 6.4. Сохранение состояния

- Корзина сохраняется в localStorage при каждом изменении
- Фильтры каталога сохраняются в URL
- Состояние авторизации сохраняется в localStorage

## 7. Обработка ошибок

### 7.1. Типы ошибок

- Ошибки валидации форм
- Ошибки загрузки данных
- Ошибки авторизации
- Ошибки добавления в корзину

### 7.2. Отображение ошибок

- Ошибки валидации отображаются под соответствующими полями
- Общие ошибки отображаются в виде уведомлений
- Критические ошибки отображаются на отдельной странице

## 8. Производительность

### 8.1. Оптимизации

- Ленивая загрузка изображений товаров
- Дебаунс для поиска (300ms)
- Виртуализация списков при большом количестве товаров
- Кэширование результатов поиска

### 8.2. Ограничения

- Максимум 20 товаров на странице каталога
- Максимум 6 изображений на странице товара
- Максимум 99 единиц одного товара в корзине

---

**Данное ТЗ описывает функциональные требования для разработки интернет-магазина TechStore.** 